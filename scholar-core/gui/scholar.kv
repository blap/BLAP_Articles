#:kivy 2.0.0

#-# Widget para um item na lista principal
<ListItem>:
    orientation: 'horizontal'
    size_hint_y: None
    height: '48dp'
    padding: '5dp'
    canvas.before:
        Color:
            rgba: (0.2, 0.4, 0.6, 1) if self.selected else (0.1, 0.1, 0.1, 1)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.9
        Label:
            text: root.title
            font_size: '16sp'
            halign: 'left'
            valign: 'top'
            text_size: self.width, None
        Label:
            text: root.author_text
            font_size: '12sp'
            color: (0.7, 0.7, 0.7, 1)
            halign: 'left'
            valign: 'top'
            text_size: self.width, None
    Label:
        text: '[b]U[/b]'
        markup: True
        font_size: '18sp'
        color: (0.2, 0.6, 1, 1)
        size_hint_x: 0.1
        opacity: 1 if root.update_available else 0

#-# Widget Raiz da Aplicação
<ScholarCoreRoot>:
    orientation: 'horizontal'
    item_list: item_list_id
    detail_view: detail_view_id

    CollectionsTree:
        id: collections_tree_id
        size_hint_x: 0.2

    RecycleView:
        id: item_list_id
        size_hint_x: 0.5
        viewclass: 'ListItem'
        data: []

        RecycleBoxLayout:
            default_size: None, dp(48)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            multiselect: False
            touch_multiselect: False

    DetailView:
        id: detail_view_id
        size_hint_x: 0.3

#-# Widget do Painel de Detalhes
<DetailView>:
    orientation: 'vertical'
    padding: '10dp'
    spacing: '10dp'

    Label:
        text: root.title
        font_size: '18sp'
        bold: True
        size_hint_y: None
        height: self.texture_size[1]
        text_size: self.width, None
        halign: 'left'
    Label:
        text: root.authors
        font_size: '14sp'
        color: (0.8, 0.8, 0.8, 1)
        size_hint_y: None
        height: self.texture_size[1]
        text_size: self.width, None
        halign: 'left'
    ScrollView:
        Label:
            text: root.details
            font_size: '12sp'
            text_size: self.width, None
            size_hint_y: None
            height: self.texture_size[1]
            halign: 'left'
    Label:
        text: "Anexos:" if root.attachments_text else ""
        font_size: '14sp'
        bold: True
        size_hint_y: None
        height: self.texture_size[1] if root.attachments_text else 0
    Label:
        text: root.attachments_text
        font_size: '12sp'
        size_hint_y: None
        height: self.texture_size[1]
    BoxLayout:
        size_hint_y: None
        height: '40dp'
        Button:
            text: 'Deletar Item'
            disabled: not root.item_id
            on_press: app.root.delete_selected_item()

#-# Popup de Informação Genérico
<InfoPopup>:
    title: "Aviso"
    size_hint: 0.6, 0.4
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        padding: '10dp'
        spacing: '10dp'
        Label:
            text: root.message
            text_size: self.width, None
            size_hint_y: 0.8
        Button:
            text: 'Ok'
            size_hint_y: 0.2
            on_press: root.dismiss()

#-# Popup de Boas-Vindas
<WelcomePopup>:
    title: "Bem-vindo ao ScholarCore!"
    size_hint: 0.8, 0.6
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        padding: '20dp'
        spacing: '20dp'
        Label:
            text: "Esta parece ser a primeira vez que você executa o ScholarCore.\\n\\nSua biblioteca pessoal será criada no seguinte local, dentro da pasta desta aplicação (tornando-a 100% portátil):"
            text_size: self.width, None
            halign: 'center'
        Label:
            text: f"[b]{root.data_path}[/b]"
            markup: True
            font_size: '12sp'
        Button:
            text: 'Entendido, vamos começar!'
            size_hint_y: None
            height: '48dp'
            on_press: root.dismiss()
